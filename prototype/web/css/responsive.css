/* Un Día Más - Responsive & Accessibility */
/* Mobile styles, accessibility, and system preferences */

/* ==========================================
   MOBILE RESPONSIVE
   ========================================== */

@media (max-width: 768px) {
    body { font-size: 16px; }

    .header-bar {
        padding: 10px;
        gap: 10px;
    }

    .stats-section {
        gap: 12px;
        order: 3;
        width: 100%;
        justify-content: center;
        padding-top: 8px;
        border-top: 1px solid rgba(255,255,255,0.1);
    }

    .stat-item {
        font-size: 13px;
    }

    .container { padding: 0 15px 30px; }

    /* Más espacio en móvil porque el header es más alto */
    .story {
        padding-top: 15px;
    }

    .choices button {
        font-size: 15px;
        padding: 12px 15px;
    }

    .modal-content {
        max-height: 90vh;
    }

    .slot-actions {
        flex-direction: column;
    }

    .slot-actions button {
        width: 100%;
    }

    .portrait-container {
        height: 25vh;
    }

    .notifications {
        bottom: calc(20px + env(safe-area-inset-bottom, 0px));
        right: 10px;
        left: 10px;
        max-height: 40vh;
    }

    /* Preferences panel mobile */
    .pref-options {
        flex-direction: column;
    }

    .theme-options .pref-btn {
        flex: 1 1 100%;
    }

    .day-progress {
        margin-left: 8px;
    }

    .day-dot {
        width: 6px;
        height: 6px;
    }
}

@media (max-width: 480px) {
    body { font-size: 15px; }

    .container { padding: 0 10px 20px; }

    .header-bar {
        padding: 8px;
    }

    /* Aún más espacio en pantallas pequeñas */
    .story {
        padding-top: 20px;
    }

    .day-name {
        font-size: 14px;
    }

    .stat-item {
        font-size: 12px;
    }

    .mini-bar .dot {
        width: 6px;
        height: 6px;
    }

    .choices button {
        font-size: 14px;
        padding: 10px 12px;
    }

    .dice-roll-box {
        padding: 12px 15px;
    }

    .dice-roll-box .dice-value {
        font-size: 1.5em;
    }

    .notification {
        font-size: 12px;
        padding: 10px 12px;
    }

    .save-actions {
        flex-direction: column;
    }

    .save-actions button {
        width: 100%;
    }
}

/* =============================================
   ACCESSIBILITY STYLES
   ============================================= */

/* Screen reader only text */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Focus indicators */
button:focus-visible,
a:focus-visible,
[tabindex]:focus-visible {
    outline: 2px solid #ffc107;
    outline-offset: 2px;
    border-radius: 4px;
}

.choices button:focus-visible {
    outline: 3px solid #ffc107;
    outline-offset: 3px;
    box-shadow: 0 0 0 6px rgba(255, 193, 7, 0.2);
}

.start-btn:focus-visible {
    outline: 3px solid #ffc107;
    outline-offset: 4px;
}

.header-btn:focus-visible {
    outline: 2px solid #ffc107;
    outline-offset: 2px;
}

.modal-close:focus-visible {
    outline: 2px solid #ffc107;
    outline-offset: 2px;
}

.pref-btn:focus-visible {
    outline: 2px solid #ffc107;
    outline-offset: 2px;
}

/* High contrast theme focus */
.theme-high-contrast button:focus-visible,
.theme-high-contrast a:focus-visible {
    outline-color: #ffffff;
    outline-width: 3px;
}

/* Skip link (hidden until focused) */
.skip-link {
    position: absolute;
    top: -40px;
    left: 0;
    background: #000;
    color: #fff;
    padding: 8px 16px;
    z-index: 10000;
    transition: top 0.2s;
}

.skip-link:focus {
    top: 0;
}

/* Game end indicator */
.story-ended {
    text-align: center;
    padding: 2rem;
    opacity: 0.8;
    font-style: italic;
}

.story-ended .end-label {
    display: inline-block;
    padding: 0.5rem 1.5rem;
    border: 1px solid currentColor;
    border-radius: 4px;
    margin-top: 1rem;
}

/* Reduced motion preference */
@media (prefers-reduced-motion: reduce) {
    * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    .notification {
        animation: none !important;
    }

    .typewriter-enabled .story p {
        animation: none !important;
    }
}

/* ==========================================
   SYSTEM PREFERENCE DETECTION
   ========================================== */

@media (prefers-color-scheme: light) {
    :root:not([data-theme-override]) {
        --bg-dark: #f5efe6;
        --bg-light: #ede4d8;
        --bg-surface: #e8dfd0;
        --text-main: #2a2520;
        --text-muted: #6b5e52;
        --text-dim: #9a8f80;
        --accent: #c4501a;
        --accent-dim: rgba(196, 80, 26, 0.2);
        --accent-glow: rgba(196, 80, 26, 0.3);
    }
}

@media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

@media (prefers-contrast: more) {
    :root:not([data-theme-override]) {
        --bg-dark: #000000;
        --bg-light: #111111;
        --bg-surface: #1a1a1a;
        --text-main: #ffffff;
        --text-muted: #cccccc;
        --accent: #ffaa00;
        --success: #00ff00;
        --danger: #ff0000;
    }
}
